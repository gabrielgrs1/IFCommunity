$(".telefone-perfil-dashboard").mask("(00) 00009-0000");function carregando(){$(".preloader-wrapper").show()}$("li.icon-materias").click(function(){$(".minhas-materias-adicionadas").slideToggle(500)});$("ul.para-scroll > li").click(function(){$("main > section.minhas-materias").empty();$("ul label li").removeClass("fundo-checked");$("section").removeClass("section-aparece");var a=$(this).children("span").text();if(a!=="Minhas matérias"){$(".minhas-materias-adicionadas").slideUp();$(".aviso-minhas-materias").hide();abreComBotaoCelular();if(a==="Gerenciar matérias"){$(".adicionar-materias div.box-padrao .row > ul.collapsible").empty();retornaMaterias()}}else{$(".aviso-minhas-materias").show()}var b="."+$(this).children("span").attr("id");qualApareceNaTela(b)});function qualApareceNaTela(a){$("section").hide();$(".site-content").find(a).addClass("section-aparece");if($("section").hasClass("section-aparece")){$(this).show()}MontaCondicoesBotaoModal($(this).children("span").text())}var materias=[];var periodoMateria=[];pegaMateriasComAjax($("#id-usuario").text());var lista=$(".lista-materias");var minhasMaterias=lista.parent();function preencheAListaDeMateriasDoMenu(){lista.detach().empty().each(function(d){if(materias.length===0){materias.push("Você ainda não tem nenhuma matéria cadastrada!")}for(var b=0;b<materias.length;b++){var c=materias.indexOf("Você ainda não tem nenhuma matéria cadastrada!");if(c!==0){for(var d=materias.length-1;d>=0;d--){if(materias[d]==="Você ainda não tem nenhuma matéria cadastrada!"){materias.splice(d,1)}}}$(this).append('<input type="radio" name="materias-radio" id="materia'+b+'" style="display:none!important" /><label for="materia'+b+'"><li><span>'+materias[b]+"</span></li></label>");if(b===materias.length-1){$(this).appendTo(minhasMaterias)}}})}function pegaMateriasComAjax(c){var e=$(".lista-materias");var a=document.createElement("li");var b=document.createElement("div");b.setAttribute("class","progress");var d=document.createElement("div");d.setAttribute("class","indeterminate");b.append(d);a.append(b);$.ajax({url:"RecuperaMaterias",type:"get",data:{idUsuario:c},beforeSend:function(){e.append(a)}}).done(function(g){e.empty();for(var f=0;f<g.length;f++){materias.push(g[f])}preencheAListaDeMateriasDoMenu();checkedNasMateriasDoMenu()}).fail(function(f,h,g){e.empty();if(f.status===500){console.log("Erro 500, não foi possível estabelecer conexão com o servidor!")}else{if(f.status===502){console.log("Erro 502, não foi possível estabelecer conexão!")}else{if(f.status===404){console.log("Erro 404, não foi encontrado o diretório solicitado!")}}}preencheAListaDeMateriasDoMenu()})}function checkedNasMateriasDoMenu(){$("input[name='materias-radio']").click(function(){$(".aviso-minhas-materias").hide();var a;if($(this).is(":checked")){$("ul label li").removeClass("fundo-checked");$(this).next("label").children("li").addClass("fundo-checked");a=$(this).next("label").children("li").children("span").text()}limpaCamposPostagem();MontaCondicoesBotaoModal(a);abreComBotaoCelular();pegaPostagensDaMateriaSelecionada()})}function abreComBotaoCelular(){$(".nav-side .nav-toggle").parent().toggleClass("nav-open")}$(".nav-side .nav-toggle").on("click",function(a){a.preventDefault();$(this).parent().toggleClass("nav-open")});$(document).ready(function(){$("select").material_select()});$("select").material_select("destroy");function MontaCondicoesBotaoModal(b){var a=[];a=materias.slice(0);apareceBotaoAbrirModal(b,a)}function apareceBotaoAbrirModal(b,a){if(a.includes(b)){$(".botao-modal").show()}else{$(".botao-modal").hide()}}$("#modal1").modal({dismissible:true,opacity:0.8,inDuration:400,outDuration:250,startingTop:"90%",endingTop:"15%"});$("#modal-buscar").modal({dismissible:true,opacity:0.8,inDuration:400,outDuration:250,startingTop:"90%",endingTop:"25%"});escreverCodigo();function escreverCodigo(){$("#modal-de-escrever-codigo").click(function(){$("#formDoModal select").change(function(b){var d=$(b.target).val();var c=$(b.target).find("option:selected").text();var a=c.toLowerCase();if(a=="selecione a linguagem"){}else{adicionaOsTextAreaModal(a)}})})}function adicionaOsTextAreaModal(a){$(".paraCodigo").show();qualLinguagem(a)}var editor=ace.edit("editor");editor.setTheme("ace/theme/twilight");editor.session.setMode("ace/mode/javascript");function qualLinguagem(c){if(c=="texto"){c="text"}var a=c.toLowerCase();var b=ace.edit("editor");b.setTheme("ace/theme/twilight");b.session.setMode("ace/mode/"+a)}function qualLinguagemParaPostagem(d,c){if(d=="texto"){d="text"}var a=d.toLowerCase();var b=ace.edit("editorLeitura"+c);b.setTheme("ace/theme/twilight");b.session.setMode("ace/mode/"+a);b.setReadOnly(true)}function collapsible(){$(".collapsible").collapsible()}var postagens=[];function pegaPostagensDaMateriaSelecionada(){var a;a=$(".fundo-checked").children().text();if(a==="Você ainda não tem nenhuma matéria cadastrada!"){$(".minhas-materias-adicionadas").slideUp();console.log($("main > section.minhas-materias"));$("main > section.minhas-materias").empty();$("ul label li").removeClass("fundo-checked");$("section").removeClass("section-aparece");$(".adicionar-materias div.box-padrao .row > ul.collapsible").empty();retornaMaterias();qualApareceNaTela(".adicionar-materias")}else{console.log($("main > section.minhas-materias"));$("main > section.minhas-materias").empty();pegaPostagens(a)}}function pegaPostagens(b,a){Materialize.Toast.removeAll();$.ajax({url:"RecuperaPostagens",type:"get",timeout:8000,data:{materia:b,dataUltimaPostagem:a},beforeSend:function(){carregando()}}).done(function(c){postagens=[];$("main > section.minhas-materias").empty();for(var d=0;d<c.length;d++){postagens.push(c[d])}$(".preloader-wrapper").hide();montaPostagens(b)}).fail(function(d,e,c){Materialize.toast("Erro ao recuperar postagens, contate um administrador!",6000,"red");$(".preloader-wrapper").hide();if(d.status===500){console.log("Erro 500, não foi possível estabelecer conexão com o servidor!")}else{if(d.status===502){console.log("Erro 502, não foi possível estabelecer conexão!")}else{if(d.status===404){console.log("Erro 404, não foi encontrado o diretório solicitado!")}}}})}function montaPostagens(e){$(".minhas-materias").empty();postagens.reverse();for(var g=0;g<postagens.length;g++){var c=postagens[g]["postagens"];var b=postagens[g]["autor"];var h=postagens[g]["titulo"];var i=postagens[g]["data"];var a=postagens[g]["materia"];var f=postagens[g]["id"];var d=postagens[g]["linguagem"];adicionaPostagens(c,b,h,i,a,f,g);collapsible();if(d=="selecione a linguagem"){}else{qualLinguagemParaPostagem(d,f)}}if(postagens.length===0){$(".minhas-materias").empty();$(".minhas-materias").prepend("<div class='aviso-falta-postagens container box-padrao'><h3>Mural Vazio!</h3><div class='page-footer'><div class='container'><div class='row'><div class='col l6 s12 center-align'><h5>Ainda não há nenhuma postagem nessa matéria!</h5></div><div class='col l4 offset-l2 s12'><h5>Seja o primeiro a compartilhar algo da matéria!</h5></div></div></div></div></div>")}else{$(".minhas-materias").append("<button class='btn btn-wave' type='button' id='pega-mais-postagens'>Carregar mais...</button>")}}function adicionaPostagens(f,v,u,b,B,c,n){var w=b.split(" ");var l=w[1].split(".");var C=l[0];C=C.split(":");C=C[0]+":"+C[1];var d=w[0];d=d.split("-");d=d[2]+"/"+d[1]+"/"+d[0];b="às "+C+" "+d;var r=$("main > section.minhas-materias");var j=document.createElement("ul");var k=document.createElement("li");var m=document.createElement("div");var o=document.createElement("ul");var h=document.createElement("li");var g=document.createElement("li");var D=document.createElement("h4");var p=document.createElement("p");var e=document.createElement("p");var t=document.createElement("div");var a=document.createElement("pre");var s=document.createElement("div");var A=document.createElement("a");var z=document.createElement("i");var i=document.createElement("a");var y=document.createElement("i");var q=document.createElement("p");m.setAttribute("class","collapsible-header");D.setAttribute("class","center");D.innerHTML=u;p.innerHTML=v+"<br><span class='data-postagem' id='data-hora-postagem-'"+c+">"+b;p.setAttribute("class","right-align autor-postagem");e.setAttribute("class","setinha-indicadora center");o.setAttribute("class","container");t.setAttribute("class","collapsible-body");a.setAttribute("id","editorLeitura"+c);a.setAttribute("class","paraCodigoPostagens");a.innerHTML=f;s.setAttribute("class","botoes-das-postagens right-align");A.setAttribute("class","waves-effect waves-light btn right-align botao-curtida");z.setAttribute("class","material-icons left");z.innerHTML="thumb_up";s.setAttribute("class","botoes-das-postagens right-align");i.setAttribute("class","waves-effect waves-light btn right-align botao-curtida");y.setAttribute("class","material-icons left");y.innerHTML="thumb_down";s.setAttribute("id",c);j.setAttribute("class","collapsible content-topic z-depth-2 container row");j.setAttribute("data-collapsible","accordion");h.append(D);g.append(p);g.append(e);o.append(h);o.append(g);m.append(o);t.append(a);A.append(z);i.append(y);s.append(A);s.append(i);t.append(s);k.setAttribute("id",c);k.append(m);k.append(t);j.append(k);j.setAttribute("id",c);r.prepend(j);if(n===(postagens.length-1)){r.append("<div class='rodape'></div>")}}function retornaMaterias(){$.ajax({url:"RecuperaMateriasTelaAdicionar",type:"post",timeout:6000,beforeSend:function(){$("#section-materias #div-loading").slideDown(500)}}).done(function(b){$("#section-materias #div-loading").slideUp(500);periodoMateria=[];$(".adicionar-materias div.box-padrao .row > ul.collapsible").empty();for(var a=0;a<b.length;a++){periodoMateria.push(b[a])}gerenciarMateriasConteudo()}).fail(function(b,c,a){$("#section-materias #div-loading").slideUp(500);Materialize.Toast.removeAll();Materialize.toast("Erro ao recuperar matérias, contate um administrador!",6500,"red");if(b.status===500){console.log("Erro 500, não foi possível estabelecer conexão com o servidor!")}else{if(b.status===502){console.log("Erro 502, não foi possível estabelecer conexão!")}else{if(b.status===404){console.log("Erro 404, não foi encontrado o diretório solicitado!")}}}})}function gerenciarMateriasConteudo(){var f=[];for(var a=0;a<periodoMateria.length;a++){var c=periodoMateria[a].split(";");f.push(c[1])}var b=f.filter(function(j,h){return f.indexOf(j)===h});d(b);function d(i){var k=i.sort();for(var h=0;h<i.length;h++){var m=document.createElement("p");var n=document.createElement("div");var l=document.createElement("div");var j=("criaLi"+k[h]);j=document.createElement("li");n.setAttribute("class","collapsible-body row");n.setAttribute("id",k[h]);l.setAttribute("class","collapsible-header");l.appendChild(document.createTextNode(k[h]+"° Período"));j.append(l);j.append(n);$(".adicionar-materias div.box-padrao .row > ul.collapsible").append(j)}}e(b,periodoMateria);function e(q,o){o.sort();for(var m=0;m<o.length;m++){var p=o[m].split(";");var j=p[0];var n=p[1];var i=document.createElement("span");var h=document.createElement("li");var l=("criaLabel"+[m]);l=document.createElement("label");var k=("criaInput"+[m]);k=document.createElement("input");i.appendChild(document.createTextNode(j));h.append(i);l.setAttribute("for","test"+m);l.setAttribute("class","col s12");l.append(h);k.setAttribute("type","checkbox");k.setAttribute("id","test"+m);k.setAttribute("name",j);$(".adicionar-materias div.box-padrao .row > ul.collapsible  li").find("div.collapsible-body").each(function(){if(this.id===n){this.append(k);this.append(l)}})}}var g=$("input[type='checkbox']");g.each(function(){var h=materias.indexOf($(this).attr("name"));if(h===-1){}else{if($(this).prop("checked",false)){$(this).prop("checked",true)}}})}$(document).on("change","input[type='checkbox']",atualizaMaterias);function atualizaMaterias(){novoVetorDeMaterias=materias.slice(0);if(this.checked){var a=materias.indexOf($(this).attr("name"));if(a===-1){if(novoVetorDeMaterias.length>=7){Materialize.Toast.removeAll();Materialize.toast("Você já atingiu o máximo de matérias, remova alguma antes!",2500,"red");$(this).prop("checked",false);return}novoVetorDeMaterias.push($(this).attr("name"));materias=novoVetorDeMaterias.slice(0);materias.sort();preencheAListaDeMateriasDoMenu();checkedNasMateriasDoMenu()}}else{var c=novoVetorDeMaterias.indexOf($(this).attr("name"));novoVetorDeMaterias.splice(c,1);materias=novoVetorDeMaterias.slice(0);materias.sort();preencheAListaDeMateriasDoMenu();checkedNasMateriasDoMenu()}b(materias,$("#id-usuario").text());function b(d,e){Materialize.Toast.removeAll();console.log(d);$.ajax({url:"AtualizaMateriaTelaAdicionar",type:"get",data:{materia1:d[0],materia2:d[1],materia3:d[2],materia4:d[3],materia5:d[4],materia6:d[5],materia7:d[6],idUsuario:e},beforeSend:function(){}}).done(function(){Materialize.toast("Matéria atualizada com sucesso!",2500,"green")}).fail(function(f,h,g){if(f.status===500){console.log("Erro 500, não foi possível estabelecer conexão com o servidor!")}else{if(f.status===502){console.log("Erro 502, não foi possível estabelecer conexão!")}else{if(f.status===404){console.log("Erro 404, não foi encontrado o diretório solicitado!")}}}})}}function deslogar(){$.ajax({url:"Deslogar",type:"get"}).done(function(){window.location.href="index.jsp"}).fail(function(b,a,c){if(b.status===500){console.log("Erro 500, não foi possível estabelecer conexão com o servidor!")}else{if(b.status===502){console.log("Erro 502, não foi possível estabelecer conexão!")}else{if(b.status===404){console.log("Erro 404, não foi encontrado o diretório solicitado!")}}}})}$("#li-deslogar").on("click",function(a){a.preventDefault();deslogar()});$("#btn-atualizar-perfil").click(function(){var a=[];atualizaPerfilAJAX($("#id-usuario").text(),$(".nome-perfil-dashboard").val(),$(".telefone-perfil-dashboard").val(),$(".email-perfil-dashboard").val())});$("#btn-limpar-perfil").click(function(){if(confirm("Tem certeza que deseja limpar todos os campos?")){$(".nome-perfil-dashboard").val("");$(".telefone-perfil-dashboard").val("");$(".email-perfil-dashboard").val("");$("#btn-atualizar-perfil").addClass("disabled")}});function atualizaNomePerfil(){var a=aluno[0];a=a.split(" ");if(a.length>1){a=a[0]+" "+a[1]}else{a=a[0]}$("#nome-usuario").text(a)}function atualizaPerfilAJAX(d,b,a,c){Materialize.Toast.removeAll();$.ajax({url:"AtualizaPerfil",type:"post",timeout:12000,data:{id:d,nome:b,telefone:a,email:c},beforeSend:function(){$("#section-perfil #div-loading").slideDown(500);console.log("Atualizando dados do perfil")}}).done(function(f){$("#section-perfil #div-loading").slideUp(500);console.log(f);aluno=[];for(var e=0;e<f.length;e++){aluno.push(f[e])}atualizaNomePerfil();Materialize.toast("Perfil atualizado com sucesso!",2500,"green")}).fail(function(f,g,e){$("#section-perfil #div-loading").slideUp(500);if(f.status===500){console.log("Erro 500, não foi possível estabelecer conexão com o servidor!")}else{if(f.status===502){console.log("Erro 502, não foi possível estabelecer conexão!")}else{if(f.status===404){console.log("Erro 404, não foi encontrado o diretório solicitado!")}}}Materialize.toast("Erro ao atualizar o perfil, contate um administrador!",2500,"red")})}validacaoFormulario(".nome-perfil-dashboard","#erro-nome-perfil-dashboard",/^[a-záàâãéèêíïóôõöúçñ]{3,}[a-záàâãéèêíïóôõöúçñ\s]+$/i,"Informe um nome válido!");validacaoFormulario(".telefone-perfil-dashboard","#erro-telefone-perfil-dashboard",/^\(0?[1-9]{2}\)\s9?[0-9]{4}\-[0-9]{4}$/,"Informe um celular válido!");validacaoFormulario(".email-perfil-dashboard","#erro-email-perfil-dashboard",/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/,"Informe um email válido!");function validacaoFormulario(a,b,d,c){$(a).on("blur",function(){if($(a).val().length===0){$(b).text("Campo obrigatório!");$(a).addClass("erro-label-input");$(b).fadeIn(500)}else{$(a).addClass("erro-label-input");if(d.test(this.value)&&a!=="#matricula"){$(b).fadeOut(2000);$(a).addClass("sucesso-label-input");$(a).removeClass("erro-label-input")}else{$(b).text(c);$(b).hide();$(b).fadeIn(500);$(a).addClass("erro-label-input");$(a).removeClass("sucesso-label-input")}if(/^[a-záàâãéèêíïóôõöúçñ]{3,}[a-záàâãéèêíïóôõöúçñ\s]+$/i.test($(".nome-perfil-dashboard").val())&&/^\(0?[1-9]{2}\)\s9?[0-9]{4}\-[0-9]{4}$/.test($(".telefone-perfil-dashboard").val())&&/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/.test($(".email-perfil-dashboard").val())){$("#btn-atualizar-perfil").removeClass("disabled")}else{$("#btn-atualizar-perfil").addClass("disabled")}}})}$("#btn-submeter-postagem").click(function(e){e.stopPropagation();var d=$("[name='assunto']").val();var f=$("#formDoModal select").find("option:selected").text().toLowerCase();var j=editor.getValue();var c=$(".fundo-checked").children().text();var h=$("#id-usuario").text();var k=j.split("");var g=d.split("");var i=g.length;console.log(i);var b=k.length;console.log(b);var a=testaPost(d);if(a&&f!="selecione a linguagem"&&b>=50&&(i<=20&&i>=5)){adicionaPostagemNoBanco(d,f,j,c,h);$("#modal1").modal("close")}else{if(a==false){Materialize.toast("Preencha o assunto da postagem corretamente",6000,"red")}else{if(i>20){Materialize.toast("Você não pode postar um assunto tão extenso, resuma o mesmo!",6000,"red")}else{if(i<5){Materialize.toast("Você não pode postar um assunto tão pequeno, explique mais!",6000,"red")}else{if(f=="selecione a linguagem"){Materialize.toast("Selecione a linguagem do código",6000,"red")}else{if(b<50){Materialize.toast("Você não pode postar um código tão pequeno, aproveite o espaço!",6000,"red")}else{Materialize.toast("Erro ao adicionar postagem, contate um adiministrador",6000,"red")}}}}}}});function testaPost(a){var b=/^[a-záàâãéèêíïóôõöúçñ0-9 ]+$/i;var c=b.test(a);if(c){return true}else{return false}}function limpaCamposPostagem(){$("[name='assunto']").val("");$("#formDoModal select").prop("selectedIndex",0);$("#formDoModal select").material_select();editor.setValue("");$(".paraCodigo").hide()}function adicionaPostagemNoBanco(c,b,a,e,d){$.ajax({url:"AdicionaPostagem",type:"get",timeout:8000,data:{assunto:c,linguagem:b,conteudoDaPostagem:a,qualMateria:e,nomeDoUsuario:d},beforeSend:function(){carregando()}}).done(function(f){pegaPostagens(e);limpaCamposPostagem();Materialize.toast("Postagem enviada com sucesso!",6000,"green")}).fail(function(g,h,f){Materialize.toast("Erro ao adicionar postagem, contate um administrador!",6000,"red");$(".preloader-wrapper").hide();if(g.status===500){console.log("Erro 500, não foi possível estabelecer conexão com o servidor!")}else{if(g.status===502){console.log("Erro 502, não foi possível estabelecer conexão!")}else{if(g.status===404){console.log("Erro 404, não foi encontrado o diretório solicitado!")}}}})}$("ul.tabs").tabs();